<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Ballerina by Example: Datatables</title>
    <!--GA-->
      <script>
         (function (i, s, o, g, r, a, m) {
             i['GoogleAnalyticsObject'] = r;
             i[r] = i[r] || function () {
                 (i[r].q = i[r].q || []).push(arguments)
             }, i[r].l = 1 * new Date();
             a = s.createElement(o),
                     m = s.getElementsByTagName(o)[0];
             a.async = 1;
             a.src = g;
             m.parentNode.insertBefore(a, m)
         })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
         
         ga('create', 'UA-92163714-1', 'auto');
         ga('send', 'pageview');
         
      </script>
      <!-- Google Tag Manager -->
      <script>(function (w, d, s, l, i) {
         w[l] = w[l] || [];
         w[l].push({'gtm.start':
                     new Date().getTime(), event: 'gtm.js'});
         var f = d.getElementsByTagName(s)[0],
                 j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
         j.async = true;
         j.src =
                 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
         f.parentNode.insertBefore(j, f);
         })(window, document, 'script', 'dataLayer', 'GTM-KW2LLTW');
      </script>
      <!-- End Google Tag Manager -->
      <!-- Hotjar Tracking Code for https://ballerinalang.org/ --> 
      <script>
         (function (h, o, t, j, a, r) {
             h.hj = h.hj || function () {
                 (h.hj.q = h.hj.q || []).push(arguments)
             };
             h._hjSettings = {hjid: 442732, hjsv: 5};
             a = o.getElementsByTagName('head')[0];
             r = o.createElement('script');
             r.async = 1;
             r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
             a.appendChild(r);
         })(window, document, '//static.hotjar.com/c/hotjar-', '.js?sv=');
      </script>
    
     <link href="https://b.content.wso2.com/sites/all/bootstrap/css/bootstrap.css?230617" rel="stylesheet">
      <script src="https://b.content.wso2.com/sites/all/bootstrap/js/jquery.js?230617"></script>
      <script src="https://b.content.wso2.com/sites/all/bootstrap/js/bootstrap.js?230617"></script>
      
      <script src="http://b.content.wso2.com/sites/all/ballerina/ballerina-example.js"></script>
<script  defer="defer" src="https://wso2.cachefly.net/wso2/sites/all/ballerina/js/ballerina.js"></script>
<!--      <link rel=stylesheet href="https://ballerinalang.org/css/ballerina.css?230617">-->
    <link rel=stylesheet href="site.css">
    <link href="https://fonts.googleapis.com/css?family=Cairo:200,300,400,600,700,900" rel="stylesheet">
    <link rel=stylesheet href="http://b.content.wso2.com/sites/all/ballerina/ballerina-example.css">
    
    
  </head>
  <body>
        <div class="row cBallerinaNav" id="iBallerinaNavigation">

        </div>
      <div class="row cBallerinaBySampleRow">
          <div class="container cBallerinaBySampleContainer">
              <div class="example" id="datatables">
                  <div class="col-xs-11 col-sm-11 col-md-11">
                      <h2><a href="./">Ballerina by Example</a>: Datatables</h2>
                  </div>
                  <div class="col-xs-1 col-sm-1 col-md-1">
                      <a href="./" class="cBackButton"><img src="http://b.content.wso2.com/sites/all/ballerina/backbutton.svg"/></a>
                  </div>
                  <div class="col-xs-12 col-sm-12 col-md-12">

                      

                      <table>
                          
                          <tr>
                              <td class="docs">
                                  <p>The datatable type is used to hold tabular data, such as those returned from
an SQL database query and provides cursor based access to the data.
Use the following sql scripts to create table and
 sample data in a mysql database.</p>

<p>create table employees (
    id int,
    name varchar(25),
    salary double,
    status boolean,
    birthdate date,
    birthtime time,
    updated times tamp
);</p>

<p>insert into employees values(1, &lsquo;John&rsquo;, 1050.50, false,
&lsquo;1990-12-31&rsquo;, &lsquo;11:30:45&rsquo;, &lsquo;2007-05-23 09:15:28&rsquo;);</p>

<p>insert into employees values(2, &lsquo;Anne&rsquo;, 4060.50, true, &lsquo;1999-12-31&rsquo;,
&lsquo;13:40:24&rsquo;, &lsquo;2017-05-23 09:15:28&rsquo;);</p>

                              </td>
                              <td class="code leading">
                                  
                                  <div class="highlight"><pre><span class="kn">import</span> <span class="nx">ballerina</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">system</span><span class="p">;</span>
<span class="kn">import</span> <span class="nx">ballerina</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">datatables</span><span class="p">;</span>
<span class="kn">import</span> <span class="nx">ballerina</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">sql</span><span class="p">;</span>
</pre></div>

                              </td>
                          </tr>
                          
                          <tr>
                              <td class="docs">
                                  <p>This is the Employee struct. The field names of the this should match column names of the table. The field types should match with sql types.</p>

                              </td>
                              <td class="code leading">
                                  
                                  <div class="highlight"><pre><span class="kd">struct</span> <span class="nx">Employee</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="nx">id</span><span class="p">;</span>
    <span class="kt">string</span> <span class="nx">name</span><span class="p">;</span>
    <span class="kt">float</span> <span class="nx">salary</span><span class="p">;</span>
    <span class="kt">boolean</span> <span class="nx">status</span><span class="p">;</span>
    <span class="kt">string</span> <span class="nx">birthdate</span><span class="p">;</span>
    <span class="kt">string</span> <span class="nx">birthtime</span><span class="p">;</span>
    <span class="kt">string</span> <span class="nx">updated</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

                              </td>
                          </tr>
                          
                          <tr>
                              <td class="docs">
                                  
                              </td>
                              <td class="code leading">
                                  
                                  <div class="highlight"><pre><span class="kd">function</span> <span class="nx">main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
</pre></div>

                              </td>
                          </tr>
                          
                          <tr>
                              <td class="docs">
                                  <p>Create a SQL connector by providing the required database connection
pool properties.</p>

                              </td>
                              <td class="code leading">
                                  
                                  <div class="highlight"><pre>    <span class="kt">map</span> <span class="nx">props</span> <span class="p">=</span> <span class="p">{</span><span class="s">&quot;jdbcUrl&quot;</span><span class="p">:</span><span class="s">&quot;jdbc:mysql://localhost:3306/db&quot;</span><span class="p">,</span>
                    <span class="s">&quot;username&quot;</span><span class="p">:</span><span class="s">&quot;root&quot;</span><span class="p">,</span> <span class="s">&quot;password&quot;</span><span class="p">:</span><span class="s">&quot;root&quot;</span><span class="p">};</span>
    <span class="nx">sql</span><span class="p">:</span><span class="nx">ClientConnector</span> <span class="nx">empDB</span> <span class="p">=</span> <span class="nx">create</span> <span class="nx">sql</span><span class="p">:</span><span class="nx">ClientConnector</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
</pre></div>

                              </td>
                          </tr>
                          
                          <tr>
                              <td class="docs">
                                  <p>Query the table using SQL connector select action. Either select or call
action can return a datatable.</p>

                              </td>
                              <td class="code leading">
                                  
                                  <div class="highlight"><pre>    <span class="nx">sql</span><span class="p">:</span><span class="nx">Parameter</span><span class="p">[]</span> <span class="nx">params</span> <span class="p">=</span> <span class="p">[];</span>
    <span class="kt">datatable</span> <span class="nx">dt</span> <span class="p">=</span> <span class="nx">sql</span><span class="p">:</span><span class="nx">ClientConnector</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">empDB</span><span class="p">,</span>
                                              <span class="s">&quot;SELECT * from employees&quot;</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
</pre></div>

                              </td>
                          </tr>
                          
                          <tr>
                              <td class="docs">
                                  <p>Iterate through the result until hasNext() become false and retrieve
the data struct corresponding to each row.</p>

                              </td>
                              <td class="code leading">
                                  
                                  <div class="highlight"><pre>    <span class="k">while</span> <span class="p">(</span><span class="nx">datatables</span><span class="p">:</span><span class="nx">hasNext</span><span class="p">(</span><span class="nx">dt</span><span class="p">))</span> <span class="p">{</span>
        <span class="kt">any</span> <span class="nx">dataStruct</span> <span class="p">=</span> <span class="nx">datatables</span><span class="p">:</span><span class="nx">next</span><span class="p">(</span><span class="nx">dt</span><span class="p">);</span>
        <span class="k">var</span> <span class="nx">rs</span><span class="p">,</span> <span class="nx">_</span> <span class="p">=</span> <span class="p">(</span><span class="nx">Employee</span><span class="p">)</span><span class="nx">dataStruct</span><span class="p">;</span>
        <span class="nx">system</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Employee:&quot;</span> <span class="o">+</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s">&quot;|&quot;</span> <span class="o">+</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span>
                       <span class="s">&quot;|&quot;</span> <span class="o">+</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">salary</span> <span class="o">+</span> <span class="s">&quot;|&quot;</span> <span class="o">+</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">status</span> <span class="o">+</span>
                       <span class="s">&quot;|&quot;</span> <span class="o">+</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">birthdate</span> <span class="o">+</span>
                       <span class="s">&quot;|&quot;</span> <span class="o">+</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">birthtime</span> <span class="o">+</span>
                       <span class="s">&quot;|&quot;</span> <span class="o">+</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">updated</span><span class="p">);</span>
    <span class="p">}</span>
</pre></div>

                              </td>
                          </tr>
                          
                          <tr>
                              <td class="docs">
                                  <p>Close the datatable to clean the resources.</p>

                              </td>
                              <td class="code leading">
                                  
                                  <div class="highlight"><pre>    <span class="nx">datatables</span><span class="p">:</span><span class="nx">close</span><span class="p">(</span><span class="nx">dt</span><span class="p">);</span>
</pre></div>

                              </td>
                          </tr>
                          
                          <tr>
                              <td class="docs">
                                  <p>Convert a datatable to json.</p>

                              </td>
                              <td class="code leading">
                                  
                                  <div class="highlight"><pre>    <span class="nx">dt</span> <span class="p">=</span> <span class="nx">sql</span><span class="p">:</span><span class="nx">ClientConnector</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">empDB</span><span class="p">,</span>
                                    <span class="s">&quot;SELECT id,name from employees&quot;</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
    <span class="k">var</span> <span class="nx">jsonRes</span><span class="p">,</span> <span class="nx">_</span> <span class="p">=</span> <span class="p">&lt;</span><span class="kt">json</span><span class="p">&gt;</span><span class="nx">dt</span><span class="p">;</span>
    <span class="nx">system</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="nx">jsonRes</span><span class="p">);</span>
    <span class="nx">datatables</span><span class="p">:</span><span class="nx">close</span><span class="p">(</span><span class="nx">dt</span><span class="p">);</span>
</pre></div>

                              </td>
                          </tr>
                          
                          <tr>
                              <td class="docs">
                                  <p>Convert a datatable to xml.</p>

                              </td>
                              <td class="code leading">
                                  
                                  <div class="highlight"><pre>    <span class="nx">dt</span> <span class="p">=</span> <span class="nx">sql</span><span class="p">:</span><span class="nx">ClientConnector</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">empDB</span><span class="p">,</span>
                                    <span class="s">&quot;SELECT id,name from employees&quot;</span><span class="p">,</span> <span class="nx">params</span><span class="p">);</span>
    <span class="k">var</span> <span class="nx">xmlRes</span><span class="p">,</span> <span class="nx">_</span> <span class="p">=</span> <span class="p">&lt;</span><span class="kt">xml</span><span class="p">&gt;</span><span class="nx">dt</span><span class="p">;</span>
    <span class="nx">system</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="nx">xmlRes</span><span class="p">);</span>
    <span class="nx">datatables</span><span class="p">:</span><span class="nx">close</span><span class="p">(</span><span class="nx">dt</span><span class="p">);</span>
    
</pre></div>

                              </td>
                          </tr>
                          
                          <tr>
                              <td class="docs">
                                  <p>Finally close the DB connection.</p>

                              </td>
                              <td class="code">
                                  
                                  <div class="highlight"><pre>    <span class="nx">sql</span><span class="p">:</span><span class="nx">ClientConnector</span><span class="p">.</span><span class="nx">close</span><span class="p">(</span><span class="nx">empDB</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

                              </td>
                          </tr>
                          
                      </table>


                      

                      <table>
                          
                          <tr>
                              <td class="docs">
                                  
                              </td>
                              <td class="code">
                                  
                                  <div class="highlight"><pre><span class="gp">$</span> ballerina run main datatables.bal
<span class="go">Employee:1|John|1050.5|false|1990-12-31+05:30|</span>
<span class="go">11:30:45.000+05:30|2007-05-23T09:15:28.000+05:30</span>
<span class="go">Employee:2|Anne|4060.5|true|1999-12-31+06:00|</span>
<span class="go">13:40:24.000+05:30|2017-05-23T09:15:28.000+05:30</span>
<span class="go">[{&quot;id&quot;:1,&quot;name&quot;:&quot;John&quot;},{&quot;id&quot;:2,&quot;name&quot;:&quot;Anne&quot;}]</span>
<span class="go">&lt;results&gt;&lt;result&gt;&lt;id&gt;1&lt;/id&gt;&lt;name&gt;John&lt;/name&gt;&lt;/result&gt;</span>
<span class="go">&lt;result&gt;&lt;id&gt;2&lt;/id&gt;&lt;name&gt;Anne&lt;/name&gt;&lt;/result&gt;&lt;/results&gt;</span>
</pre></div>

                              </td>
                          </tr>
                          
                      </table>


                      
                      
                      <p class="next">
                          Next example: <a href="sql-connector">SQL Connector</a>.
                      </p>
                      

                  </div>
                  <div class="col-xs-12 col-sm-12 col-md-12 cGOfooter">
                      <p class="footer">
                          by <a href="https://twitter.com/ballerinalang">@ballerinalang</a> | <a href="mailto:ballerina-dev@googlegroups.com">feedback</a> | <a href="https://github.com/ballerinalang/ballerina/tree/ballerina-by-example-src/samples/ballerina-by-example/examples/datatables">source</a>
                      </p>
                      <p class="attrib">
                          This site was generated using a <a href="https://github.com/mmcgrana/gobyexample/">tool</a> developed by <a href="https://twitter.com/mmcgrana">@mmcgrana</a>, licensed under <a href="https://creativecommons.org/licenses/by/2.0/">CC BY</a> / modified from original
                      </p>
                  </div>
              </div>
              
          </div>
      </div>
      <div class="row cBallerinaFooter" id="iBallerinaFooter">
      </div>
      
  </body>
</html>
